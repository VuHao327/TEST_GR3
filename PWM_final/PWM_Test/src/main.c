/******************************************************************************
|------------------------------------------------------------------------------
|   FILE DESCRIPTION
|------------------------------------------------------------------------------
|    File Name:   <main>.<c>
|    Description: Source file for task 2
|------------------------------------------------------------------------------
|
|------------------------------------------------------------------------------
|               A U T H O R   I D E N T I T Y
|------------------------------------------------------------------------------
| Name: Group3
|------------------------------------------------------------------------------
|               EXECUTION NOTE
|------------------------------------------------------------------------------
| Note: information for use when execute this program
| ---------------------------------------------------------------------------*/

/******************************************************************************
 *  INCLUDES
 *****************************************************************************/

#include "my_S32K144.h"

/******************************************************************************
 *  DEFINES & MACROS
 *****************************************************************************/

/******************************************************************************
 *  EXTERN
 *****************************************************************************/

/******************************************************************************
 *  VARIABLES
 *****************************************************************************/

/******************************************************************************
 *  FUNCTION PROTOTYPES
 *****************************************************************************/

/******************************************************************************
 *  FUNCTION DECLARATION
 *****************************************************************************/

int main(void)
{

	/*!
	 * Initialization:
	 * =======================
	 */
	/* ENABLE NVIC */
	NVIC->ISER[1] |= (1u<<1); 	/* NVIC LPUART1 */
	NVIC->ISER[1] |= (1u<<29);	/* NVIC PORTC */

	/* SETTING BUTTONS */
	GPIO_Init('C', 12, IN, enable_IRQ);	/* set PORTC pin12 as input with interrupt */
	GPIO_Init('C', 13, IN, enable_IRQ);	/* set PORTC pin13 as input with interrupt */
	GPIO_Init('C', 3, IN, enable_IRQ);	/* set PORTC pin14 as input with interrupt */

	/* LPUART INIT */
	LPUART_Init();	/* LPUART1 RX TX with interrupt */

	/* INIT FTM */
	FTM_PWM_Init(); /* FTM0 channel0 Edge-Aligned PWM
	 	 	 	 	 	Frequency 2Khz duty cycle 50% */
	UART_Display(); /* Send data to UART at beginning */

	/*!
	 * Infinite for:
	 * ========================
	 */
	for (;;) {
		/* Check if sw4 is pressed */
		if (e_sw4_state_u8 == 1) {
			Frequency_Change();			/* Switch between 2Khz <-> 4Khz */
			UART_Display();				/* Display to terminal */
		}
		/* Check if sw2 is pressed */
		if (e_sw2_state_u8 == 1) {
			Duty_Cycle_Increase();		/* Increase duty cycle by 10% */
			UART_Display();				/* Display to terminal */
		}
		/* Check if sw3 is pressed */
		else if (e_sw3_state_u8 == 1) {
			Duty_Cycle_Decrease();		/* Decrease duty cycle by 10% */
			UART_Display();				/* Display to terminal */
		}
		else {
			/* Do nothing */
		}
	}
}

/******************************************************************************
*                           End of File                                       *
******************************************************************************/
